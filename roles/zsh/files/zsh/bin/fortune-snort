#!/bin/bash
# bit of fun!

# This initial echo sets the color of the speech bubble
echo -ne "\033[030m"

if [ $(whereis fortune | awk '{ print $2 }') ]
then
    if [ $(whereis cowsay | awk '{ print $2 }') ]
    then
        # This then formats the fortune output and pipes it into the cowsay command
        # The color of the pig is set within the /usr/share/cowsay/cows/snort.cow file
        fortune | perl -e '
            my $buffer;
            foreach my $line (<>) {
                chomp $line;
                $line =~ s/\s+/ /g;
                $line = "\n\n$line" if ($line =~ m/^[QA]:\s/ && $buffer);
                $buffer .= "$line ";
            }
            print $buffer;' | cowsay -W $1 -f snort
    else
        fortune | perl -e '
            my $buffer;
            foreach my $line (<>) {
                chomp $line;
                $line =~ s/\s+/ /g;
                $line = "\n\n$line" if ($line =~ m/^[QA]:\s/ && $buffer);
                $buffer .= "$line ";
            }
            print $buffer;'
    fi
fi

# vim: set ai et sw=4 syntax=sh :
